<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel Final v2 - Fiscal CORE-SE</title>
    <style>
        /* ... Seu CSS original aqui, igual ao que voc√™ enviou ... */
        :root { --primary-color: #005a9c; --secondary-color: #28a745; --highlight-color: #fffbe6;
        --danger-color: #dc3545; --light-gray: #f8f9fa; --border-color: #ddd; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background-color: #f4f7f9; color: #333; margin: 0; padding: 20px; display: flex; justify-content: center; }
        .container { width: 100%; max-width: 1200px; background-color: #fff; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); padding: 30px; }
        /* ... todo o resto igual ao seu CSS ... */
        .firebase-login { display: flex; flex-direction: column; align-items: center; justify-content: center; margin: 60px 0;}
        .firebase-login button { background: #4285F4; color: #fff; border: none; padding: 10px 30px; border-radius: 5px; font-size: 1.2em; cursor: pointer; }
        .firebase-avatar { border-radius: 50%; width: 52px; height: 52px; margin: 0 10px; }
        .user-info-bar { margin-bottom: 20px; display: flex; align-items: center; justify-content: flex-end;}
        .user-info-bar span { color: #005a9c; font-weight: bold; margin-right: 12px;}
    </style>
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.8.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore-compat.js"></script>
</head>
<body>
    <div id="firebaseLogin" class="firebase-login" style="display: none;">
        <p>Fa√ßa login com sua conta Google para salvar e acessar seu progresso:</p>
        <button id="firebaseGoogleLoginBtn">Entrar com Google</button>
    </div>
    <div class="container" id="appMain" style="display:none;">
        <div class="user-info-bar" id="userBar" style="display:none;">
            <img class="firebase-avatar" id="userAvatar" src="" alt="Usu√°rio" />
            <span id="userName"></span>
            <button onclick="logoutFirebase()" style="margin-left:18px;color:#fff;background:#d9534f;padding:8px 15px;border-radius:4px;border:none;font-weight:600;">Sair</button>
        </div>
        <!-- ...Todo o restante do seu HTML original (painel, tabelas, calend√°rio, backup, modal) aqui... -->
        <!-- Cole seu HTML sem mexer, est√° igual ao que voc√™ enviou -->
        <!-- Abaixo est√° seu conte√∫do do painel -->
        <!-- -------- AQUI VAI O SEU HTML J√Å ENVIADO, sem mexer -------- -->
        <!-- ...BEGIN PAINEL HTML (voc√™ j√° enviou acima, n√£o removi nada) ... -->
        <h1>Painel de Performance - Fiscal CORE-SE</h1>
        <div class="progress-container">
            <p id="progressText">Progresso Total: 0%</p>
            <div class="progress-bar"><div id="progressBar"></div></div>
        </div>
        <details open><summary>üìÖ Calend√°rio de Estudos e Prazos</summary>
            <div class="calendar-container">
                <div class="calendar-header">
                    <button id="prevMonthBtn">&lt;</button>
                    <h2 id="calendarMonthYear" style="border:none; margin:0;"></h2>
                    <button id="nextMonthBtn">&gt;</button>
                </div>
                <div class="calendar-grid" id="calendarWeekdays"></div>
                <div class="calendar-grid" id="calendarDays"></div>
                <div class="calendar-legend">
                    <h3>Legenda:</h3>
                    <div class="legend-item"><span class="legend-icon" style="background-color: #d4edda; border-radius:4px; padding: 2px 5px;"> Dia </span> = Dia de Estudo Registrado</div>
                    <div class="legend-item"><span class="legend-icon">‚úèÔ∏è</span> = Dia com Anota√ß√£o Pessoal</div>
                    <div class="legend-item"><span class="legend-icon">üèÅ</span> = DIA DA PROVA</div>
                    <div class="legend-item"><span class="legend-icon">üö©</span> = Fim do Per√≠odo de Inscri√ß√£o</div>
                    <div class="legend-item"><span class="legend-icon">üí∞</span> = √öltimo Dia para Pagamento</div>
                    <div class="legend-item"><span class="legend-icon">üìç</span> = Divulga√ß√£o dos Locais de Prova</div>
                    <div class="legend-item"><span class="legend-icon">üìã</span> = Divulga√ß√£o do Gabarito Preliminar</div>
                </div>
            </div>
        </details>
        <details><summary>üéØ T√≥picos do Edital</summary>
            <table id="topicsTable">
                <thead><tr><th>Prioridade</th><th>Conclu√≠do</th><th>Disciplina</th><th>Conte√∫do</th><th>Conclu√≠do em</th></tr></thead>
                <tbody></tbody>
            </table>
        </details>
        <details><summary>üìä Controle de Simulados</summary>
            <table id="simuladosTable" class="dynamic-table">
                <thead><tr><th>Data</th><th>N¬∫ Quest√µes</th><th>Acertos</th><th>% Acerto</th><th>Observa√ß√µes</th><th>A√ß√£o</th></tr></thead>
                <tbody></tbody>
            </table>
            <button id="addSimulado" class="action-button">Adicionar Simulado</button>
        </details>
        <div class="backup-section">
             <h3>üõ°Ô∏è Backup do Progresso</h3>
             <button id="exportBtn">Exportar Progresso</button>
             <textarea id="backupData" readonly></textarea>
             <div class="import-group">
                  <p>Para restaurar, cole seu c√≥digo de backup abaixo:</p>
                  <textarea id="importData"></textarea>
                  <button id="importBtn">Importar Progresso</button>
             </div>
        </div>
        <div id="notesModal" class="modal-overlay">
            <div class="modal-content">
                <h3 id="modalTitle"></h3>
                <textarea id="modalTextarea" placeholder="Digite aqui o que voc√™ estudou, suas d√∫vidas, etc..."></textarea>
                <div class="modal-buttons" style="text-align: right;">
                    <button id="modalSaveBtn" class="action-button">Salvar</button>
                    <button id="modalCancelBtn" style="background-color: #6c757d;">Cancelar</button>
                </div>
            </div>
        </div>
    </div>
    <!-- -----FIM DO HTML----- -->
    <script>
    // ---- FIREBASE CONFIG SUA ----
    const firebaseConfig = {
      apiKey: "AIzaSyDF4olxhSBZaRwo7JQuhw-ZV-6gJa0VdFQ",
      authDomain: "gui-core.firebaseapp.com",
      projectId: "gui-core",
      storageBucket: "gui-core.firebasestorage.app",
      messagingSenderId: "459808373619",
      appId: "1:459808373619:web:259a71fcf4a14c3acbe306",
      measurementId: "G-QRLKK7CRB7"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    let currentUser = null;

    function showLogin(show = true) {
        document.getElementById("firebaseLogin").style.display = show ? "flex" : "none";
        document.getElementById("appMain").style.display = show ? "none" : "block";
    }
    function showUserBar(user) {
        const userBar = document.getElementById("userBar");
        document.getElementById("userAvatar").src = user.photoURL;
        document.getElementById("userName").textContent = user.displayName;
        userBar.style.display = "flex";
    }
    // LOGIN GOOGLE
    document.getElementById("firebaseGoogleLoginBtn").onclick = function() {
        const provider = new firebase.auth.GoogleAuthProvider();
        firebase.auth().signInWithPopup(provider);
    };
    firebase.auth().onAuthStateChanged(async (user) => {
        if (user) {
            currentUser = user;
            showLogin(false);
            showUserBar(user);
            await carregarProgressoFirebase();
            inicializarPainelExistente();
        } else {
            showLogin(true);
        }
    });
    window.logoutFirebase = function() {
        firebase.auth().signOut();
        location.reload();
    };

    // SINCRONIZA√á√ÉO NUVEM
    async function salvarProgressoFirebase() {
        if (!currentUser) return;
        const allData = coletarDadosLocais();
        await db.collection('progresso').doc(currentUser.uid).set(allData);
    }
    async function carregarProgressoFirebase() {
        if (!currentUser) return;
        const doc = await db.collection('progresso').doc(currentUser.uid).get();
        if (doc.exists) {
            aplicarDadosLocais(doc.data());
        }
    }
    function coletarDadosLocais() {
        const allData = {
            topics: {},
            simulados: JSON.parse(localStorage.getItem('simuladosData') || '[]'),
            calendarNotes: JSON.parse(localStorage.getItem('calendarNotes') || '{}')
        };
        if(document.querySelectorAll('#topicsTable input[type="checkbox"]').length)
        document.querySelectorAll('#topicsTable input[type="checkbox"]').forEach(cb => {
            const item = localStorage.getItem(cb.id);
            if(item) allData.topics[cb.id] = JSON.parse(item);
        });
        return allData;
    }
    function aplicarDadosLocais(allData) {
        Object.keys(localStorage).forEach(k=>{
            if(/^item-/.test(k) || ['simuladosData','calendarNotes'].includes(k)) localStorage.removeItem(k);
        });
        if (allData.topics) Object.keys(allData.topics).forEach(id => localStorage.setItem(id, JSON.stringify(allData.topics[id])));
        if (allData.simulados) localStorage.setItem('simuladosData', JSON.stringify(allData.simulados));
        if (allData.calendarNotes) localStorage.setItem('calendarNotes', JSON.stringify(allData.calendarNotes));
    }

    // PAINEL/JAVASCRIPT NORMAL (com chamadas para sincronia):
    function inicializarPainelExistente() {
     )
    }
    </script>
</body>
</html>
